(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-df7dad0e"],{7274:function(t,e,a){"use strict";var i=a("a27e");e["a"]={getCity:function(t){return Object(i["b"])("/cityarea",t)},getActive:function(t){return Object(i["a"])("/cityactives",t)},add:function(t){return Object(i["b"])("/cityactive",t)},update:function(t,e){return Object(i["c"])("/cityactive/".concat(t),e)},remove:function(t){return Object(i["d"])("/cityactive/".concat(t))},updateStatus:function(t,e){return Object(i["c"])("/cityactive/".concat(t),e)},getLevel:function(t){return Object(i["a"])("/levels",t)},updateLevel:function(t,e){return Object(i["c"])("/level/".concat(t),e)}}},d194:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.form}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{placeholder:"省份",clearable:""},on:{change:function(e){return t.getCityCity(t.cityname.province)}},model:{value:t.cityname.province,callback:function(e){t.$set(t.cityname,"province",e)},expression:"cityname.province"}},[a("el-option",{key:"0",attrs:{label:"请选择省份",value:"0"}}),t._l(t.province,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2),a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"城市",clearable:""},on:{change:function(e){return t.getCityArea(t.cityname.city)}},model:{value:t.cityname.city,callback:function(e){t.$set(t.cityname,"city",e)},expression:"cityname.city"}},t._l(t.city,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{placeholder:"区县",clearable:""},model:{value:t.cityname.area,callback:function(e){t.$set(t.cityname,"area",e)},expression:"cityname.area"}},t._l(t.area,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:function(e){return t.timeChange(t.date)}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:function(e){return t.add()}}},[t._v("添加")])],1)],1),a("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{border:"",data:t.cityactives,"row-key":"id"}},[a("el-table-column",{attrs:{label:"ID",prop:"id",sortable:"custom",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.id))])]}}])}),a("el-table-column",{attrs:{label:"城市",width:"300px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.city_fullname))])]}}])}),a("el-table-column",{attrs:{label:"活动时间","min-width":"150px"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{staticClass:"link-type"},[t._v(t._s(i.start_time)+"-"+t._s(i.end_time))])]}}])}),a("el-table-column",{attrs:{label:"添加时间","min-width":"150px"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{staticClass:"link-type"},[t._v(t._s(i.add_time))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.showDialog(e.row)}}},[t._v("修改")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.remove(e.row)}}},[t._v("删除")])]}}])})],1),t.cityactives.length>0?a("el-pagination",{attrs:{layout:"prev, pager, next","current-page":t.form.p,total:t.total,background:""},on:{"current-change":t.search}}):t._e(),a("div",[a("el-dialog",{attrs:{title:"修改时间",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"dialogForm",attrs:{model:t.selectData,rules:t.rules,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"省份",prop:"controller"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{placeholder:"省份",clearable:""},on:{change:function(e){return t.getCityCity(t.selectData.pronvice_id)}},model:{value:t.selectData.pronvice_id,callback:function(e){t.$set(t.selectData,"pronvice_id",e)},expression:"selectData.pronvice_id"}},[a("el-option",{key:"0",attrs:{label:"请选择省份",value:"0"}}),t._l(t.province,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2)],1),a("el-form-item",{attrs:{label:"城市",prop:"action"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"城市",clearable:""},on:{change:function(e){return t.getCityArea(t.selectData.city_id)}},model:{value:t.selectData.city_id,callback:function(e){t.$set(t.selectData,"city_id",e)},expression:"selectData.city_id"}},t._l(t.city,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"区县",prop:"powername"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{placeholder:"区县",clearable:""},model:{value:t.selectData.area_id,callback:function(e){t.$set(t.selectData,"area_id",e)},expression:"selectData.area_id"}},t._l(t.area,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"活动时间",prop:"sort"}},[a("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:function(e){return t.timeChange(t.date)}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.updateDialog}},[t._v("确 定")]),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)],1)},n=[],c=a("7274"),l={data:function(){return{activeTmie:0,date:"",time:{startDate:"",endDate:""},formLabelWidth:"120px",cityname:{province:"",city:"",area:""},province:[],city:[],area:[],form:{p:1,c:10},cityactives:[],total:0,tagType:["success","info","warning","danger"],dialogVisible:!1,selectData:{}}},created:function(){this.getCity(),this.getCityActive()},methods:{randomType:function(t){return t[Math.ceil(4*Math.random())]},search:function(t){this.form.p=t,this.getCityActive()},add:function(){var t=this,e={pronvice_id:this.cityname.province,city_id:this.cityname.city,area_id:this.cityname.area,start_time:this.time.startDate/1e3,end_time:this.time.endDate/1e3};c["a"].add(e).then((function(e){t.getCityActive()}))},getCity:function(){var t=this;c["a"].getCity().then((function(e){t.province=e}))},getCityCity:function(t){var e=this;this.cityname.city="",this.cityname.area="",c["a"].getCity({pid:t}).then((function(t){e.city=t}))},getCityArea:function(t){var e=this;this.cityname.area="",c["a"].getCity({pid:t}).then((function(t){e.area=t}))},getCityActive:function(){var t=this;c["a"].getActive(this.form).then((function(e){t.cityactives=e.rs||[],t.total=e.total||0}))},timeChange:function(t){if("number"==typeof t){if(0==t)return void(this.date=[]);var e=new Date,a=e.getTime(),i=60*e.getTimezoneOffset()*1e3,n=parseInt(a/1e3/3600/24),c=1e3*(n-t)*3600*24+i,l=3600*(n+1)*1e3*24-1+i;this.date=[new Date(c),new Date(l)],this.time.startDate=c,this.time.endDate=l}else this.activeTmie=0,t[0]&&t[1]&&(this.time.startDate=t[0].getTime(),this.time.endDate=t[1].getTime());console.log(this.time)},remove:function(t){var e=this;this.$confirm("确认要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c["a"].remove(t.id).then((function(){e.$message({type:"success",message:"删除成功"}),e.getCityActive()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},showDialog:function(t){this.dialogVisible=!0,this.selectData=JSON.parse(JSON.stringify(t)),this.getCityCity(this.selectData.pronvice_id),this.getCityArea(this.selectData.city_id)},updateDialog:function(){var t=this,e=this.selectData.id,a={pronvice_id:this.selectData.pronvice_id,city_id:this.selectData.city_id,area_id:this.selectData.area_id,start_time:this.time.startDate/1e3,end_time:this.time.endDate/1e3};this.$refs["dialogForm"].validate((function(i){i&&c["a"].update(e,a).then((function(){t.$message({type:"success",message:"修改成功"}),t.dialogVisible=!1,t.getCityActive()}))}))}}},r=l,s=a("2877"),o=Object(s["a"])(r,i,n,!1,null,"509b3cf2",null);e["default"]=o.exports}}]);